import{a as W}from"./chunk-Z7ZIKLXD.js";import{a as Mt,b as St,c as Q,d as vt,f as wt}from"./chunk-XOEGTAZY.js";import{a as dt,b as gt,c as ft,d as Ct,e as xt,f as ht}from"./chunk-FWEEK3AB.js";import{r as _t}from"./chunk-X4ZPY7MU.js";import{A as G,B as mt,F as P,G as $,H as ct,I as pt,K as O,L as q,b as y,d as C,f as I,g as E,j as T,l as N,m as k,o as V,p as rt,q as D,r as z,t as H,u as R,v as j,w as B,x as lt,y as L,z as A}from"./chunk-TC6JZHBV.js";import"./chunk-RGNDWIHZ.js";import"./chunk-TBBBRDCQ.js";import"./chunk-7E4ZDMYO.js";import{a as bt}from"./chunk-LJR3HAMU.js";import{a as st,b as ut}from"./chunk-NMDXMUNG.js";import{h as ot,j as nt}from"./chunk-D3SPV6B2.js";import{$b as v,Cb as h,Db as K,Fb as U,Gb as X,Hb as o,Ib as n,Jb as b,Lb as M,Ob as p,Qb as m,Zb as et,_b as r,ac as Y,bb as l,bc as it,cb as u,f as tt,g as _,gc as F,hc as at,ma as w,vb as x,wa as g,xa as f,xb as c}from"./chunk-XMWXLGNA.js";var J=tt(bt());var Z=tt(bt());function zt(a,d){if(a&1){let t=M();o(0,"mat-card")(1,"mat-card-header")(2,"mat-card-title")(3,"h2",0),r(4),n()()(),o(5,"mat-card-content")(6,"form",1),p("ngSubmit",function(){g(t);let i=m();return f(i.onSubmit())}),o(7,"mat-form-field",2)(8,"mat-label"),r(9,"Nombre"),n(),b(10,"input",3),o(11,"mat-error"),r(12," El campo es requerido "),n()(),o(13,"mat-form-field",2)(14,"mat-label"),r(15,"Descripci\xF3n"),n(),b(16,"textarea",4),o(17,"mat-error"),r(18," El campo es requerido "),n()(),o(19,"div",5)(20,"button",6),r(21," Cancelar "),n(),o(22,"button",7),p("click",function(){g(t);let i=m();return f(i.cleanForm())}),r(23," Limpiar "),n(),o(24,"button",8),r(25," Guardar "),n()()()()()}if(a&2){let t=m();l(4),it(" ",t.dataCatalogue.catalogue?"Editar":"Crear"," ",t.dataCatalogue.title," "),l(2),c("formGroup",t.form),l(4),c("maxLength",50),l(6),c("maxLength",255),l(8),c("disabled",t.form.invalid)}}var Ft=(()=>{class a{data;fb;catalogueSvc;dialogRef;matDialog;dataCatalogue;form;catalogueDependency=[];constructor(t,e,i,s,S){this.data=t,this.fb=e,this.catalogueSvc=i,this.dialogRef=s,this.matDialog=S}ngOnInit(){this.dataCatalogue=this.data,this.form=this.fb.group({name:["",C.compose([C.required,C.maxLength(50)])],description:["",C.compose([C.required,C.maxLength(255)])]}),this.dataCatalogue.catalogue&&this.form.patchValue({name:this.dataCatalogue.catalogue.name,description:this.dataCatalogue.catalogue.description})}cleanForm(){this.form.patchValue({name:"",description:"",catalogueParentId:null})}onSubmit(){return _(this,null,function*(){if(this.form.valid){if(this.data.afterComplete){let e=this.form.value;e.id=this.dataCatalogue.catalogue?.id,this.data.afterComplete(e,this.matDialog,this.dialogRef);return}(yield Z.default.fire({title:"\xBFQuieres guardar los cambios?",showCancelButton:!0,confirmButtonText:"Guardar",icon:"question"})).isConfirmed&&(this.dataCatalogue.catalogue?this.catalogueSvc.update(this.dataCatalogue.catalogue.id,this.dataCatalogue.typeCatalogue,this.form.value).subscribe(e=>{this.closeDialog()}):this.catalogueSvc.create(this.form.value,this.dataCatalogue.typeCatalogue).subscribe(e=>{this.closeDialog()}))}})}closeDialog(){return _(this,null,function*(){yield Z.default.fire({title:"La operaci\xF3n se realizo con \xE9xito",icon:"success",confirmButtonText:"Aceptar"}),this.dialogRef.close({modify:!0})})}static \u0275fac=function(e){return new(e||a)(u(St),u(V),u(W),u(Mt),u(Q))};static \u0275cmp=w({type:a,selectors:[["app-catalogue-form"]],standalone:!0,features:[F],decls:1,vars:1,consts:[[1,"title"],[3,"ngSubmit","formGroup"],[1,"w-full","mb-3"],["matInput","","placeholder","Nombre","formControlName","name",3,"maxLength"],["matInput","","placeholder","descripcion","formControlName","description","cdkTextareaAutosize","","cdkAutosizeMinRows","1","cdkAutosizeMaxRows","5",3,"maxLength"],[1,"flex","justify-end","w-full","flex-wrap"],["mat-raised-button","","type","button","mat-dialog-close","","color","warn",1,"ml-[5px]","mt-[5px]"],["mat-raised-button","","type","button",1,"ml-[5px]","mt-[5px]",3,"click"],["mat-raised-button","","color","primary","type","submit",1,"ml-[5px]","mt-[5px]",3,"disabled"]],template:function(e,i){e&1&&x(0,zt,26,6,"mat-card"),e&2&&h(i.dataCatalogue?0:-1)},dependencies:[A,R,B,L,j,D,T,y,I,E,N,k,q,O,P,G,mt,ct,H,z,$,wt,vt,pt,_t],styles:["h2[_ngcontent-%COMP%]{margin:0 0 5px;font-weight:700}"]})}return a})();var Ht=()=>[5,10,15,20];function Rt(a,d){if(a&1){let t=M();o(0,"button",17),p("click",function(){let i=g(t).$implicit,s=m(3).$implicit,S=m(2);return f(S.clickSubMenu(i,s))}),o(1,"mat-icon"),r(2),n(),o(3,"span"),r(4),n()()}if(a&2){let t=d.$implicit;l(2),v(t.icon),l(2),v(t.text)}}function jt(a,d){if(a&1&&U(0,Rt,5,2,"button",18,K),a&2){let t=m(4);X(t.subMenu)}}function Bt(a,d){if(a&1){let t=M();o(0,"button",17),p("click",function(){g(t);let i=m().$implicit,s=m(2);return f(s.openForm(i))}),o(1,"mat-icon"),r(2,"edit"),n(),o(3,"span"),r(4,"Editar"),n()(),x(5,jt,2,0),o(6,"button",17),p("click",function(){g(t);let i=m().$implicit,s=m(2);return f(s.deleteCatalogue(i))}),o(7,"mat-icon"),r(8,"delete"),n(),o(9,"span"),r(10,"Borrar"),n()()}if(a&2){let t=m(3);l(5),h(t.subMenu?5:-1)}}function Lt(a,d){a&1&&(o(0,"button",16),r(1," No puede editar ni borrar este rol "),n()),a&2&&c("disabled",!0)}function At(a,d){if(a&1&&(o(0,"mat-card",13)(1,"mat-card-header")(2,"mat-card-title")(3,"h3",14),r(4),n()(),o(5,"mat-card-subtitle")(6,"p"),r(7),n()()()(),o(8,"mat-menu",15,0),x(10,Bt,11,1)(11,Lt,2,1,"button",16),n()),a&2){let t=d.$implicit,e=et(9),i=m(2);c("matMenuTriggerFor",e),l(4),Y(" ",t.name," "),l(3),v(t.description),l(3),h(i.typeCatalogue!="rol"?10:11)}}function Gt(a,d){if(a&1){let t=M();o(0,"section",11),U(1,At,12,4,null,null,K),n(),o(3,"footer")(4,"mat-paginator",12),p("page",function(i){g(t);let s=m();return f(s.changePagination(i))}),n()()}if(a&2){let t=m();l(),X(t.catalogues),l(3),c("length",t.catalogueSize)("pageSize",10)("pageIndex",t.pageNumber)("pageSizeOptions",at(4,Ht))}}function Pt(a,d){a&1&&b(0,"img",10)}var de=(()=>{class a{actRouter;fb;catalogueSvc;dialog;router;constructor(t,e,i,s,S){this.actRouter=t,this.fb=e,this.catalogueSvc=i,this.dialog=s,this.router=S}title="";typeCatalogue="";form;catalogues=[];subMenu=[];afterComplete;pageNumber=0;pageSize=10;catalogueSize=0;ngOnInit(){this.form=this.fb.group({nameCont:[""]}),this.title=this.actRouter.snapshot.data.titleShow,this.typeCatalogue=this.actRouter.snapshot.data.typeCatalogue,this.subMenu=this.actRouter.snapshot.data.subMenu,this.afterComplete=this.actRouter.snapshot.data.afterComplete,this.getCatalogues(this.pageNumber,this.pageSize)}clickSubMenu(t,e){typeof t.click=="string"?this.router.navigate([t.click,e.id]):t.click(e.id)}getCatalogues(t,e){this.catalogueSvc.get(this.typeCatalogue,t+1,e,this.form.value,!1).subscribe(i=>{i.total>0?(this.catalogues=i.items,this.catalogueSize=i.total):(this.catalogues=[],this.catalogueSize=0,J.default.fire("No se encontraron registros","","info"))})}changePagination(t){this.pageNumber=t.pageIndex,this.pageSize=t.pageSize,this.getCatalogues(this.pageNumber,this.pageSize)}deleteCatalogue(t){return _(this,null,function*(){(yield J.default.fire({title:"\xBFEstas seguro de eliminar este registro?",text:`Eliminar ${t.name}`,icon:"warning",showCancelButton:!0})).isConfirmed&&this.catalogueSvc.delete(t.id,this.typeCatalogue).subscribe(()=>_(this,null,function*(){yield J.default.fire("Eliminado","Registro eliminado","success"),this.pageNumber=0,this.getCatalogues(this.pageNumber,this.pageSize)}))})}searchCatalogue(){this.pageNumber=0,this.getCatalogues(this.pageNumber,this.pageSize)}cleanForm(){this.form.patchValue({nameCont:""}),this.pageNumber=0,this.getCatalogues(this.pageNumber,10)}openForm(t){let e={typeCatalogue:this.typeCatalogue,title:this.title,catalogue:t,afterComplete:this.afterComplete};this.dialog.open(Ft,{width:"60%",minWidth:"280px",data:e}).afterClosed().subscribe(i=>{i?.modify&&this.getCatalogues(this.pageNumber,this.pageSize)})}static \u0275fac=function(e){return new(e||a)(u(ot),u(V),u(W),u(Q),u(nt))};static \u0275cmp=w({type:a,selectors:[["app-catalogues-home"]],standalone:!0,features:[F],decls:19,vars:5,consts:[["menu","matMenu"],[1,"flex","justify-between","flex-wrap"],[1,"title","text-orange-600"],["mat-raised-button","",1,"sm:mb-0","mb-[10px]",3,"click"],[1,"w-full"],[1,"flex","sm:justify-between","justify-center","flex-wrap","w-full",3,"ngSubmit","formGroup"],["matInput","","C\xF3digo","Nombre","formControlName","nameCont"],[1,"flex","justify-end","w-full","flex-wrap"],["mat-raised-button","","type","button",1,"ml-[5px]","mt-[5px]",3,"click"],["mat-raised-button","","color","primary","type","submit",1,"ml-[5px]","mt-[5px]",3,"disabled"],["src","./assets/img/noFound.webp","alt","",1,"sm:w-[40%]","w-[90%]","left-0","right-0","mx-auto","rounded-3xl"],[1,"flex","flex-wrap"],[1,"rounded-xl",3,"page","length","pageSize","pageIndex","pageSizeOptions"],[1,"w-[250px]","m-[5px]","cursor-pointer","pb-4","overflow-x-auto","pl-4",3,"matMenuTriggerFor"],[1,"titleItem"],["xPosition","after"],["mat-menu-item","",3,"disabled"],["mat-menu-item","",3,"click"],["mat-menu-item",""]],template:function(e,i){e&1&&(o(0,"section",1)(1,"h2",2),r(2),n(),o(3,"button",3),p("click",function(){return i.openForm()}),r(4),n()(),o(5,"mat-card",4)(6,"mat-card-content")(7,"form",5),p("ngSubmit",function(){return i.searchCatalogue()}),o(8,"mat-form-field",4)(9,"mat-label"),r(10,"Nombre"),n(),b(11,"input",6),n(),o(12,"div",7)(13,"button",8),p("click",function(){return i.cleanForm()}),r(14," Limpiar "),n(),o(15,"button",9),r(16," Buscar "),n()()()()(),x(17,Gt,5,5)(18,Pt,1,0,"img",10)),e&2&&(l(2),v(i.title),l(2),Y(" Crear ",i.title.toLowerCase()," "),l(3),c("formGroup",i.form),l(8),c("disabled",i.form.invalid),l(2),h(i.catalogues.length>0?17:18))},dependencies:[A,R,B,L,lt,j,H,z,D,T,y,I,E,N,k,$,P,G,q,O,Ct,gt,dt,ft,ut,st,ht,xt,rt]})}return a})();export{de as CataloguesHomeComponent};

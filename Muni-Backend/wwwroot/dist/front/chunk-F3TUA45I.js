import{a as b,b as fe,c as g}from"./chunk-JRMGAHIZ.js";import{a as de}from"./chunk-Z7ZIKLXD.js";import{a as ue}from"./chunk-ZNMI3GQT.js";import{a as ce,b as pe}from"./chunk-XOEGTAZY.js";import{a as q,b as z}from"./chunk-AGJGSIFL.js";import"./chunk-AKPSIYXH.js";import"./chunk-FWEEK3AB.js";import{q as se,r as le}from"./chunk-X4ZPY7MU.js";import{A as Z,B as ee,F as te,G as ie,H as ne,K as re,L as me,b as H,d,f as V,g as L,j as Q,l as G,m as O,n as $,o as P,q as U,t as K,u as W,w as X,z as Y}from"./chunk-TC6JZHBV.js";import"./chunk-RGNDWIHZ.js";import"./chunk-TBBBRDCQ.js";import"./chunk-7E4ZDMYO.js";import{a as Se}from"./chunk-LJR3HAMU.js";import{a as oe,b as ae}from"./chunk-NMDXMUNG.js";import{ga as J}from"./chunk-D3SPV6B2.js";import{$b as j,Cb as M,Db as y,Fb as E,Gb as F,Hb as i,Ib as o,Jb as u,Lb as w,Ob as R,Qb as T,Ub as D,Vb as k,Wb as A,Zb as N,_b as t,ac as c,bb as r,cb as s,f as xe,g as v,gc as S,lc as B,ma as x,vb as C,wa as I,xa as _,xb as p}from"./chunk-XMWXLGNA.js";function be(a,f){if(a&1&&(i(0,"mat-option",7),t(1),o()),a&2){let e=f.$implicit;p("value",e.id),r(),j(e.name)}}var ve=(()=>{class a{data;fb;matDialog;svc;catalogueSvc;dataInfo;types=[];constructor(e,n,m,l,he){this.data=e,this.fb=n,this.matDialog=m,this.svc=l,this.catalogueSvc=he}ngOnInit(){this.catalogueSvc.get("type",100,0,void 0,!0).subscribe(e=>{this.types=e.items,this.dataInfo={title:"Reporte",form:this.fb.group({location:["",[d.required,d.maxLength(250)]],description:["",[d.required,d.maxLength(250)]],title:["",[d.required,d.maxLength(50)]],typeId:["",[d.required]]}),data:this.data.data,dialogRef:this.matDialog,post:this.svc.post.bind(this.svc),put:this.svc.put.bind(this.svc)}})}static \u0275fac=function(n){return new(n||a)(s(pe),s(P),s(ce),s(g),s(de))};static \u0275cmp=x({type:a,selectors:[["app-report-form"]],standalone:!0,features:[S],decls:28,vars:5,consts:[[3,"data"],[3,"formGroup"],[1,"w-full","mb-3"],["matInput","","formControlName","title",3,"maxlength"],["matInput","","formControlName","description","cdkTextareaAutosize","","cdkAutosizeMinRows","3","cdkAutosizeMaxRows","5",3,"maxlength"],["matInput","","formControlName","location","cdkTextareaAutosize","","cdkAutosizeMinRows","3","cdkAutosizeMaxRows","5",3,"maxlength"],["formControlName","typeId"],[3,"value"]],template:function(n,m){n&1&&(i(0,"app-form-cms",0)(1,"form",1)(2,"mat-form-field",2)(3,"mat-label"),t(4,"Titulo"),o(),u(5,"input",3),i(6,"mat-error"),t(7,"El campo es requerido"),o()(),i(8,"mat-form-field",2)(9,"mat-label"),t(10,"Descripci\xF3n"),o(),u(11,"textarea",4),i(12,"mat-error"),t(13,"El campo es requerido"),o()(),i(14,"mat-form-field",2)(15,"mat-label"),t(16,"Ubicaci\xF3n"),o(),u(17,"textarea",5),i(18,"mat-error"),t(19,"El campo es requerido"),o()(),i(20,"mat-form-field",2)(21,"mat-label"),t(22,"Tipo"),o(),i(23,"mat-select",6),E(24,be,2,2,"mat-option",7,y),o(),i(26,"mat-error"),t(27,"El campo es requerido"),o()()()()),n&2&&(p("data",m.dataInfo),r(),p("formGroup",m.dataInfo.form),r(4),p("maxlength",50),r(6),p("maxlength",250),r(6),p("maxlength",250),r(7),F(m.types))},dependencies:[fe,ie,te,Z,ee,me,re,ne,U,Q,H,V,L,$,G,O,le,se,J]})}return a})();var h=xe(Se());function Ie(a,f){a&1&&(i(0,"mat-icon",8),t(1,"thumb_up"),o())}function _e(a,f){a&1&&(i(0,"mat-icon"),t(1,"thumb_up_off_alt"),o())}function Me(a,f){if(a&1){let e=w();i(0,"p",6),t(1,"Titulo:"),o(),t(2),i(3,"p",6),t(4,"Description:"),o(),t(5),i(6,"p",6),t(7,"Ubicaci\xF3n:"),o(),t(8),i(9,"p",6),t(10,"Creado por:"),o(),t(11),i(12,"p",6),t(13,"Estado:"),o(),t(14),i(15,"p",6),t(16,"Tipo:"),o(),t(17),u(18,"br"),i(19,"button",7),R("click",function(){let m=I(e).$implicit,l=T();return _(l.vote(m))}),C(20,Ie,2,0,"mat-icon",8)(21,_e,2,0,"mat-icon"),i(22,"span",8),t(23),o()()}if(a&2){let e=f.$implicit;r(2),c(" ",e.title," "),r(3),c(" ",e.description," "),r(3),c(" ",e.location," "),r(3),c(" ",e.userCreate.name," "),r(3),c(" ",e.status.name," "),r(3),c(" ",e.type.name," "),r(3),M(e.voteMe?20:21),r(3),c("Votos: ",e.votes,"")}}var We=(()=>{class a{svc;authSvc;financialSvc;localStorage;homeCms;constructor(e,n,m,l){this.svc=e,this.authSvc=n,this.financialSvc=m,this.localStorage=l}homeSvc;available=0;spent=0;getFinancialData(){this.financialSvc.getBudget().subscribe(e=>{e.success&&(this.available=e.data[0].availableAmount,this.spent=e.data[0].committedAmount)})}ngOnInit(){this.localStorage.hasItem("tokenFinancial")?this.getFinancialData():this.financialSvc.auth().subscribe(e=>{e.success?(this.localStorage.setItem("tokenFinancial",e.data.token,.2),this.getFinancialData()):this.localStorage.removeItem("tokenFinancial")}),this.homeSvc={title:"Reportes",get:this.svc.get.bind(this.svc),delete:this.svc.delete.bind(this.svc),formComponent:ve,showDelete:!1,showEdit:!1,submenu:[{text:"Eliminar",click:e=>v(this,null,function*(){(yield h.default.fire({title:"\xBFTe gustar\xEDa archivar este reporte?",icon:"question",showConfirmButton:!0,showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"})).isConfirmed&&this.svc.delete(e.id).subscribe(m=>v(this,null,function*(){yield h.default.fire("Se archivo el archivo"),this.homeCms.getData(this.homeCms.pageNumber,this.homeCms.pageSize)}))}),icon:"archive",show:e=>e.userCreate.userName==this.authSvc.getAuth()?.userName}]}}vote(e){return v(this,null,function*(){(yield h.default.fire({title:e.voteMe?"\xBFTe gustar\xEDa anular el voto para este reporte?":"\xBFTe gustar\xEDa votar por este reporte?",icon:"question",showConfirmButton:!0,showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"})).isConfirmed&&this.svc.vote(e.id).subscribe(m=>v(this,null,function*(){yield h.default.fire({icon:"success",text:"Has votado con exito"}),this.homeCms.getData(this.homeCms.pageNumber,this.homeCms.pageSize)}))})}static \u0275fac=function(n){return new(n||a)(s(g),s(z),s(ue),s(q))};static \u0275cmp=x({type:a,selectors:[["app-reports-home"]],viewQuery:function(n,m){if(n&1&&D(b,5),n&2){let l;k(l=A())&&(m.homeCms=l.first)}},standalone:!0,features:[S],decls:16,vars:4,consts:[["cellTemplate",""],[1,"mb-[15px]"],[1,"flex","justify-between"],[1,"w-[300px]","m-[10px]"],[1,"title"],[3,"homeSvc","templateRef"],[1,"subtitleItem"],[1,"border-2","border-black","rounded-md","p-2","flex","justify-center","items-center","hover:bg-slate-100",3,"click"],[1,"m-1"]],template:function(n,m){if(n&1&&(i(0,"mat-card",1)(1,"mat-card-content")(2,"section",2)(3,"div",3)(4,"h2",4),t(5,"Presupuesto gastado:"),o(),i(6,"h2"),t(7),o()(),i(8,"div",3)(9,"h2",4),t(10,"Presupuesto Disponible:"),o(),i(11,"h2"),t(12),o()()()()(),u(13,"app-home-cms",5),C(14,Me,24,8,"ng-template",null,0,B)),n&2){let l=N(15);r(7),c("Q.",m.spent.toFixed(2),""),r(5),c("Q.",m.available.toFixed(2),""),r(),p("homeSvc",m.homeSvc)("templateRef",l)}},dependencies:[b,K,ae,oe,Y,W,X]})}return a})();export{We as ReportsHomeComponent};
